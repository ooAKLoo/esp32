# ESP32 MPU6050 陀螺仪传感器项目

## 📋 项目简介

本项目实现了ESP32与MPU6050六轴传感器的数据读取和姿态解算，可以实时获取：

- 三轴陀螺仪数据（角速度）
- 三轴加速度计数据
- 温度数据
- 融合后的姿态角（Roll、Pitch、Yaw）
- 运动状态检测

## 🛠 硬件需求

### 必需硬件

- **ESP32开发板** × 1
- **MPU6050模块** × 1
- **杜邦线** × 4根
- **USB数据线** × 1（用于连接电脑）

### 可选硬件

- 面包板（方便接线）
- 上拉电阻 2×4.7kΩ（如果I2C通信不稳定）

## 💻 软件需求

### 开发环境

- **Arduino IDE** 2.0或更高版本
- **macOS/Windows/Linux** 操作系统

### 必需的开发板支持

在Arduino IDE中安装ESP32开发板支持：

1. 打开 **Arduino IDE** → **首选项**

2. 在"附加开发板管理器网址"添加：

   ```
   https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
   ```

3. 打开 **工具** → **开发板** → **开发板管理器**

4. 搜索"ESP32"并安装

## 🔌 接线说明

### 标准接线方案

| MPU6050引脚 | ESP32引脚 | 说明                       |
| ----------- | --------- | -------------------------- |
| VCC         | 3.3V      | 电源正极（部分模块可接5V） |
| GND         | GND       | 电源负极                   |
| SCL         | GPIO22    | I2C时钟线                  |
| SDA         | GPIO21    | I2C数据线                  |
| AD0         | GND或悬空 | I2C地址选择（接GND=0x68）  |
| INT         | 不连接    | 中断引脚（本项目未使用）   |

### 接线示意图

```
     ESP32                  MPU6050
   ┌────────┐             ┌─────────┐
   │     3V3├─────────────┤VCC      │
   │     GND├─────────────┤GND      │
   │   GPIO22├─────────────┤SCL      │
   │   GPIO21├─────────────┤SDA      │
   │        │             │AD0──┐   │
   └────────┘             └─────┴───┘
                                 │
                                GND
```

## 📦 安装步骤

### 1. 硬件连接

1. 按照上述接线说明连接ESP32和MPU6050
2. 通过USB线将ESP32连接到电脑

### 2. 查找串口

在macOS终端运行：

```bash
ls /dev/cu.*
```

找到类似 `/dev/cu.usbserial-0001` 的设备

### 3. Arduino IDE设置

1. 打开Arduino IDE
2. **工具** → **开发板** → 选择 "ESP32 Dev Module"
3. **工具** → **端口** → 选择对应的串口（如 `/dev/cu.usbserial-0001`）
4. **工具** → **Upload Speed** → 115200（如果上传失败可以降低速度）

### 4. 上传代码

1. 复制项目代码到Arduino IDE
2. 点击"上传"按钮（→箭头图标）
3. 等待编译和上传完成

### 5. 查看输出

1. 打开串口监视器（**工具** → **串口监视器**）
2. 设置波特率为 **115200**
3. 按ESP32的 **EN/RST** 按钮重启

## 📊 使用说明

### 串口输出说明

程序会输出以下信息：

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
原始数据 | 加速度: 328, -512, 16230 | 陀螺仪: 125, -234, 45
陀螺仪 (°/s) | X: 0.4 | Y: -2.0 | Z: 0.2
加速度 (g)   | X: 0.02 | Y: -0.03 | Z: 0.99
角度 (°)     | Roll: -1.7 | Pitch: 1.2 | Yaw: 0.5
温度: 24.3 °C
```

### 数据含义

| 数据类型 | 单位 | 说明                       |
| -------- | ---- | -------------------------- |
| 陀螺仪   | °/s  | 三轴角速度                 |
| 加速度   | g    | 三轴加速度（1g = 9.8m/s²） |
| Roll     | °    | 横滚角（绕X轴旋转）        |
| Pitch    | °    | 俯仰角（绕Y轴旋转）        |
| Yaw      | °    | 偏航角（绕Z轴旋转）        |
| 温度     | °C   | 传感器温度                 |

### 坐标系定义

- **X轴**：指向前方
- **Y轴**：指向右侧
- **Z轴**：指向上方

## ⚙️ 参数调整

### 更新频率

修改 `loop()` 函数中的延时：

```cpp
delay(100);  // 100ms = 10Hz
// delay(50);   // 50ms = 20Hz
// delay(20);   // 20ms = 50Hz
```

### 互补滤波器系数

调整滤波器融合比例（总和必须为1）：

```cpp
angleX = 0.96 * angleX + 0.04 * accelAngleX;
// 0.96 = 陀螺仪权重
// 0.04 = 加速度计权重
```

### 运动检测阈值

```cpp
if (totalGyro > 100) {  // 快速运动阈值
    Serial.println("🔄 检测到快速运动！");
} else if (totalGyro > 30) {  // 普通运动阈值
    Serial.println("➡️ 检测到运动");
}
```

### 倾斜报警角度

```cpp
if (abs(angleX) > 45) {  // 45度报警阈值
    Serial.println("⚠️ X轴倾斜过大！");
}
```

## 🔧 故障排除

### 1. 上传失败

**错误信息**：`Could not open port: Resource busy`

**解决方法**：

- 关闭串口监视器
- 重新插拔USB线
- 运行 `lsof | grep usbserial` 查找占用进程

### 2. MPU6050连接失败

**错误信息**：`MPU6050连接失败!`

**解决方法**：

1. 检查接线是否正确
2. 运行I2C扫描器确认地址
3. 检查电源电压（3.3V或5V）
4. 更换杜邦线

### 3. 数据异常跳动

**现象**：角度数据剧烈跳动

**解决方法**：

- 增加滤波器系数（如0.98）
- 降低I2C速度
- 添加上拉电阻
- 远离电磁干扰源

### 4. 串口无输出

**解决方法**：

- 确认波特率为115200
- 按RST按钮重启
- 检查串口选择是否正确

## 📈 性能优化

### 提高精度

1. 增加校准采样数量（`samples = 1000`）
2. 使用更高的陀螺仪和加速度计精度
3. 实现温度补偿

### 降低噪声

1. 使用卡尔曼滤波器替代互补滤波器
2. 增加硬件滤波电容
3. 使用屏蔽线缆

### 扩展功能

- 添加磁力计实现9轴融合
- 实现四元数姿态解算
- 添加WiFi/蓝牙数据传输
- 集成OLED显示屏显示数据

## 📝 版本历史

### v1.0 (2024-08)

- 基础MPU6050数据读取
- 互补滤波器实现
- 运动检测功能
- 温度读取

## 📄 许可证

MIT License - 可自由使用和修改

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📧 联系方式

如有问题，请在GitHub上提交Issue。

------

**提示**：首次运行时，请保持设备静止3-5秒以完成自动校准。





我已经创建了一份完整的README文档！这份文档包含了运行项目所需的所有信息：

## 📚 文档特点：

1. **快速开始指南** - 5步即可运行项目
2. **详细接线图表** - 清晰的引脚对应关系
3. **故障排除指南** - 解决常见的4类问题
4. **参数调整说明** - 可根据需求自定义
5. **性能优化建议** - 提升精度和稳定性

## 💡 使用建议：

### 保存文档

1. 将README.md保存到项目文件夹
2. 与Arduino代码文件放在一起
3. 可以上传到GitHub分享

### 快速参考

最常用的部分：

- **接线说明** - 第一次连接时查看
- **故障排除** - 遇到问题时查看
- **参数调整** - 优化性能时参考

### 分享项目

如果要分享给其他人，只需提供：

1. Arduino代码文件（.ino）
2. README.md文档
3. 硬件清单

## 🎯 后续可以添加的内容：

1. **视频教程链接**
2. **3D打印外壳文件**
3. **数据可视化工具**
4. **手机APP控制**
5. **更多应用案例**

这份文档应该能让任何人都能顺利运行你的项目了！有什么需要补充或修改的地方吗？